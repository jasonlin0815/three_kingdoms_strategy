# Analytics System Design

> æ•¸æ“šåˆ†æåœ–è¡¨è¨­è¨ˆè¦åŠƒæ–‡ä»¶

---

## 1. æ•¸æ“šåŸºç¤ï¼ˆé£Ÿæç›¤é»ï¼‰

### 1.1 æ ¸å¿ƒè¨ˆç®—å–®ä½ï¼šMemberPeriodMetrics

æ¯å€‹æˆå“¡ã€æ¯å€‹ Period éƒ½æœ‰ä¸€ç­†è¨˜éŒ„ï¼ŒåŒ…å«ï¼š

| é¡åˆ¥ | æ¬„ä½ | èªªæ˜ |
|------|------|------|
| **Diff å€¼** | `contribution_diff` | æœŸé–“è²¢ç»å¢é‡ |
| | `merit_diff` | æœŸé–“æˆ°åŠŸå¢é‡ |
| | `assist_diff` | æœŸé–“åŠ©æ”»å¢é‡ |
| | `donation_diff` | æœŸé–“æç»å¢é‡ |
| | `power_diff` | æœŸé–“å‹¢åŠ›å€¼è®ŠåŒ–ï¼ˆå¯è² ï¼‰ |
| **æ—¥å‡å€¼** | `daily_contribution` | æ—¥å‡è²¢ç» |
| | `daily_merit` | æ—¥å‡æˆ°åŠŸ â­ æ ¸å¿ƒæŒ‡æ¨™ |
| | `daily_assist` | æ—¥å‡åŠ©æ”» |
| | `daily_donation` | æ—¥å‡æç» |
| **æ’å** | `start_rank` | æœŸåˆæ’åï¼ˆæ–°æˆå“¡ç‚º nullï¼‰ |
| | `end_rank` | æœŸæœ«æ’å |
| | `rank_change` | æ’åè®ŠåŒ–ï¼ˆè² =é€²æ­¥ï¼‰ |
| **ç‹€æ…‹** | `end_power` | æœŸæœ«å‹¢åŠ›å€¼ |
| | `end_state` | æœŸæœ«æ‰€å±¬å· |
| | `end_group` | æœŸæœ«åˆ†çµ„ |
| | `is_new_member` | æ˜¯å¦æœ¬æœŸæ–°åŠ å…¥ |

### 1.2 Period çµæ§‹

```
Period:
  - id: UUID
  - season_id: UUID
  - start_date: date      # æœŸé–“é–‹å§‹æ—¥æœŸ
  - end_date: date        # æœŸé–“çµæŸæ—¥æœŸ
  - days: int             # æœŸé–“å¤©æ•¸
  - period_number: int    # è³½å­£å…§æœŸæ•¸ï¼ˆ1, 2, 3...ï¼‰
  - start_upload_id: UUID | null  # ç¬¬ä¸€æœŸç‚º null
  - end_upload_id: UUID
```

### 1.3 ç¾æœ‰æŸ¥è©¢èƒ½åŠ›

| æ–¹æ³• | ç”¨é€” |
|------|------|
| `get_by_period_with_member()` | å–å¾—æŸæœŸæ‰€æœ‰æˆå“¡æŒ‡æ¨™ |
| `get_by_member()` | å–å¾—æŸæˆå“¡æ‰€æœ‰æœŸé–“æŒ‡æ¨™ï¼ˆè¶¨å‹¢åˆ†æï¼‰ |
| `get_group_averages()` | å–å¾—æŸæœŸå„çµ„åˆ¥å¹³å‡å€¼ |

---

## 2. å€‹äººå±¤ç´šåˆ†æ

### 2.1 æˆ°åŠŸéš¨æ™‚é–“è¶¨å‹¢åœ–ï¼ˆæ ¸å¿ƒåœ–è¡¨ï¼‰

**é‡è¦æ€§**ï¼šâ­â­â­â­â­ï¼ˆç”¨æˆ¶æ˜ç¢ºæ¨™è¨»ç‚ºæœ€é‡è¦æŒ‡æ¨™ï¼‰

**æ•¸æ“šæº**ï¼š`MemberPeriodMetrics.daily_merit` è·¨å¤šå€‹ Period

| ç¶­åº¦ | èªªæ˜ |
|------|------|
| X è»¸ | Periodï¼ˆå¯ç”¨ `period_number` æˆ– `end_date` æ¨™ç¤ºï¼‰ |
| Y è»¸ | æ—¥å‡æˆ°åŠŸ (`daily_merit`) |

**åœ–è¡¨é¡å‹æ¨è–¦**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨è–¦ï¼šLine Chart                                        â”‚
â”‚                                                          â”‚
â”‚  å„ªé»ï¼š                                                  â”‚
â”‚  - è¦–è¦ºåŒ–è¶¨å‹¢æ˜é¡¯ï¼Œæ¸…æ™°å‘ˆç¾ä¸Šå‡/ä¸‹é™/æ³¢å‹•                â”‚
â”‚  - å¯ç–ŠåŠ åŒç›Ÿå¹³å‡ç·šä½œç‚ºå°æ¯”åŸºæº–                          â”‚
â”‚  - å¯é¸é…ç§»å‹•å¹³å‡ç·šæ¸›å°‘å–®æœŸæ³¢å‹•                          â”‚
â”‚                                                          â”‚
â”‚  æ›¿ä»£æ–¹æ¡ˆï¼šBar Chart                                     â”‚
â”‚  - é©åˆå¼·èª¿æ¯æœŸç¨ç«‹è¡¨ç¾                                  â”‚
â”‚  - å¯åœ¨æŸ±å­ä¸Šæ–¹æ¨™è¨»å…·é«”æ•¸å€¼                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¡ç”ŸæŒ‡æ¨™**ï¼š
- ç’°æ¯”è®ŠåŒ–ç‡ï¼š`(ç•¶æœŸ - ä¸ŠæœŸ) / ä¸ŠæœŸ * 100%`
- æ»¾å‹•å¹³å‡ï¼š3 æœŸæˆ– 5 æœŸç§»å‹•å¹³å‡
- Z-Scoreï¼šèˆ‡åŒç›Ÿå¹³å‡çš„æ¨™æº–å·®è·é›¢

### 2.2 æˆ°åŠŸèˆ‡æ•´é«”æ¯”è¼ƒ

**æ¯”è¼ƒåƒç…§ç³»**ï¼š
1. åŒç›Ÿæ—¥å‡æˆ°åŠŸï¼ˆæ‰€æœ‰æˆå“¡ `daily_merit` å¹³å‡ï¼‰
2. çµ„åˆ¥æ—¥å‡æˆ°åŠŸï¼ˆåŒçµ„æˆå“¡ `daily_merit` å¹³å‡ï¼‰
3. è‡ªå·±ä¸Šä¸€æœŸ `daily_merit`

**åœ–è¡¨é¡å‹é¸æ“‡**ï¼š

| å ´æ™¯ | åœ–è¡¨é¡å‹ | èªªæ˜ |
|------|----------|------|
| å–®æœŸæ•¸å€¼æ¯”è¼ƒ | Grouped Bar Chart | ä¸¦æ’æ¯”è¼ƒå€‹äºº vs çµ„åˆ¥ vs ç›Ÿ |
| å¤šç¶­åº¦æ¯”è¼ƒ | Radar Chart | è²¢ç»/æˆ°åŠŸ/åŠ©æ”»/æç» æ¨™æº–åŒ–å¾Œå‘ˆç¾ |
| è¶¨å‹¢å°æ¯” | Dual-axis Line Chart | å€‹äººç·š + ç›Ÿå¹³å‡ç·šç–ŠåŠ  |

```
Radar Chart è¨­è¨ˆæ³¨æ„äº‹é …ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å› å„æŒ‡æ¨™é‡ç´šå·®ç•°å¤§ï¼Œéœ€å…ˆæ¨™æº–åŒ–ï¼š                         â”‚
â”‚                                                          â”‚
â”‚  æ¨™æº–åŒ–æ–¹å¼ï¼šç™¾åˆ†ä½æ’å (0-100)                          â”‚
â”‚  percentile = (æ’åä½ç½® / ç¸½äººæ•¸) * 100                  â”‚
â”‚                                                          â”‚
â”‚  è»¸ï¼š                                                    â”‚
â”‚  - è²¢ç»æ’åç™¾åˆ†ä½                                        â”‚
â”‚  - æˆ°åŠŸç™¾åˆ†ä½                                            â”‚
â”‚  - åŠ©æ”»ç™¾åˆ†ä½                                            â”‚
â”‚  - æç»ç™¾åˆ†ä½                                            â”‚
â”‚                                                          â”‚
â”‚  å¤šé‚Šå½¢ç–ŠåŠ ï¼šå€‹äºº vs çµ„åˆ¥å¹³å‡ vs åŒç›Ÿå¹³å‡                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 åŠ©æ”»åˆ†æ

**é‡è¦æ€§**ï¼šâ­â­ï¼ˆç”¨æˆ¶æ˜ç¢ºè¡¨ç¤ºç›¸å°ä¸é‡è¦ï¼‰

**è¨­è¨ˆåŸå‰‡**ï¼š
- æ²¿ç”¨æˆ°åŠŸåœ–è¡¨é¡å‹ï¼ˆLine Chart è¶¨å‹¢ + Bar Chart æ¯”è¼ƒï¼‰
- ä½œç‚ºæ¬¡è¦ Tab æˆ–æ‘ºç–Šå€å¡Šå‘ˆç¾
- å¯æ•´åˆè‡³ Radar Chart ä½œç‚ºç¶­åº¦ä¹‹ä¸€

### 2.4 è²¢ç»æ’åæ­·å²

**é‡è¦æ€§**ï¼šâ­â­â­ï¼ˆç°¡å–®å‘ˆç¾ï¼‰

**æ•¸æ“šæº**ï¼š`MemberPeriodMetrics.end_rank` + `rank_change`

**åœ–è¡¨é¡å‹æ¨è–¦**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨è–¦ï¼šInverted Line Chart                               â”‚
â”‚                                                          â”‚
â”‚  è¨­è¨ˆè¦é»ï¼š                                              â”‚
â”‚  - Y è»¸åè½‰ï¼š1 åœ¨ä¸Šæ–¹ = æ’åè¶Šå¥½è¶Šé«˜                      â”‚
â”‚  - æ’åæ•¸å­—ç›´æ¥æ¨™è¨»åœ¨æ•¸æ“šé»ä¸Š                            â”‚
â”‚  - é¡è‰²ç·¨ç¢¼ï¼š                                            â”‚
â”‚    ğŸŸ¢ ç¶ è‰²ï¼šæ’åä¸Šå‡                                     â”‚
â”‚    ğŸ”´ ç´…è‰²ï¼šæ’åä¸‹é™                                     â”‚
â”‚    âšª ç°è‰²ï¼šæŒå¹³                                         â”‚
â”‚                                                          â”‚
â”‚  Hover é¡¯ç¤ºï¼š                                            â”‚
â”‚  - æœŸé–“åç¨±                                              â”‚
â”‚  - æ’åè®ŠåŒ–ï¼ˆå¦‚ â†‘5, â†“3ï¼‰                                 â”‚
â”‚  - åŒæœŸç¸½äººæ•¸                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.5 æç»è¨˜éŒ„

**é‡è¦æ€§**ï¼šâ­ï¼ˆç°¡å–®è¨˜éŒ„å³å¯ï¼‰

**æ•¸æ“šæº**ï¼š`MemberPeriodMetrics.donation_diff`

**åœ–è¡¨é¡å‹æ¨è–¦**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨è–¦ï¼šSimple Bar Chart                                  â”‚
â”‚                                                          â”‚
â”‚  è¨­è¨ˆè¦é»ï¼š                                              â”‚
â”‚  - æ¯æœŸä¸€æ ¹æŸ±å­                                          â”‚
â”‚  - é«˜åº¦ = donation_diff                                  â”‚
â”‚  - æŸ±å­ä¸Šæ–¹æ¨™è¨»å…·é«”æ•¸å€¼                                  â”‚
â”‚  - ç„¡éœ€æ¯”è¼ƒåƒç…§ç³»                                        â”‚
â”‚                                                          â”‚
â”‚  ç°¡åŒ–æ–¹æ¡ˆï¼šSparkline                                     â”‚
â”‚  - ç”¨æ–¼ç©ºé–“å—é™çš„å ´æ™¯                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. çµ„åˆ¥å±¤ç´šåˆ†æ

> **æ ¸å¿ƒå·®ç•°**ï¼šèˆ‡å€‹äººåˆ†æä¸åŒï¼Œçµ„åˆ¥åˆ†æçš„æ ¸å¿ƒåƒ¹å€¼åœ¨æ–¼ã€Œç¾¤é«”è¡Œç‚ºæ¨¡å¼ã€å’Œã€Œåˆ†ä½ˆç‰¹å¾µã€ã€‚
> ç›Ÿä¸»/å®˜å“¡é—œå¿ƒçš„çµ„åˆ¥å•é¡Œï¼šç¸¾æ•ˆã€ç©©å®šæ€§ã€çµæ§‹å¥åº·åº¦ã€è¶¨å‹¢æ–¹å‘ã€‚

### 3.1 è¨ˆç®—é‚è¼¯

**é—œéµæ¦‚å¿µ**ï¼šäººæ—¥å‡ï¼ˆPer Capita Daily Averageï¼‰

```python
# çµ„åˆ¥äººæ—¥å‡æˆ°åŠŸè¨ˆç®—
group_daily_merit_per_capita = SUM(merit_diff) / (days * member_count)

# ç­‰åƒ¹æ–¼
group_daily_merit_per_capita = AVG(daily_merit)  # çµ„å…§æˆå“¡æ—¥å‡æˆ°åŠŸçš„å¹³å‡
```

**åˆ†ä½ˆçµ±è¨ˆæŒ‡æ¨™**ï¼ˆçµ„åˆ¥åˆ†æçš„æ ¸å¿ƒå¢é‡ï¼‰ï¼š

```python
class GroupDistributionStats:
    """çµ„åˆ¥åˆ†ä½ˆçµ±è¨ˆ - æ­ç¤ºçµ„å…§çµæ§‹å¥åº·åº¦"""

    # åŸºç¤çµ±è¨ˆ
    mean: Decimal              # å¹³å‡å€¼
    median: Decimal            # ä¸­ä½æ•¸
    std: Decimal               # æ¨™æº–å·®
    cv: Decimal                # è®Šç•°ä¿‚æ•¸ = std / meanï¼ˆè¶Šä½è¶Šç©©å®šï¼‰

    # å››åˆ†ä½æ•¸ï¼ˆBox Plot æ‰€éœ€ï¼‰
    min: Decimal
    q1: Decimal                # ç¬¬ä¸€å››åˆ†ä½ï¼ˆ25th percentileï¼‰
    q3: Decimal                # ç¬¬ä¸‰å››åˆ†ä½ï¼ˆ75th percentileï¼‰
    max: Decimal
    iqr: Decimal               # å››åˆ†ä½è· = Q3 - Q1

    # é›¢ç¾¤å€¼
    outliers_high: list[dict]  # é«˜æ–¼ Q3 + 1.5*IQR çš„æˆå“¡
    outliers_low: list[dict]   # ä½æ–¼ Q1 - 1.5*IQR çš„æˆå“¡
```

**å±¤ç´šåˆ†ä½ˆæŒ‡æ¨™**ï¼š

```python
class TierDistribution:
    """è²¢ç»å±¤ç´šåˆ†ä½ˆ - è­˜åˆ¥ä¾è³´å‹çµ„åˆ¥"""

    top_20_pct: TierStats      # é ‚å±¤ 20% æˆå“¡
    mid_60_pct: TierStats      # ä¸­å±¤ 60% æˆå“¡
    bot_20_pct: TierStats      # åº•å±¤ 20% æˆå“¡

class TierStats:
    count: int                 # è©²å±¤ç´šäººæ•¸
    total_merit: int           # è©²å±¤ç´šç¸½æˆ°åŠŸ
    share: Decimal             # ä½”çµ„ç¸½æˆ°åŠŸæ¯”ä¾‹ï¼ˆ0-1ï¼‰
```

**å¥åº·åº¦æŒ‡æ¨™**ï¼š

```python
class GroupHealthScores:
    """çµ„åˆ¥å¥åº·åº¦å¤šç¶­è©•åˆ†ï¼ˆ0-100ï¼‰"""

    performance: int           # ç›¸å°ç›Ÿå¹³å‡çš„è¡¨ç¾ç™¾åˆ†ä½
    stability: int             # è¡¨ç¾ç©©å®šæ€§ = (1 - CV) * 100
    uniformity: int            # åƒèˆ‡å‡å‹»åº¦ = (1 - top30%ä½”æ¯”) * 100
    activity: int              # æ´»èºæˆå“¡æ¯”ä¾‹
    growth: int                # ç›¸æ¯”ä¸ŠæœŸçš„æˆé•·ç‡
```

---

### 3.2 çµ„åˆ¥è¡¨ç¾ç®±å½¢åœ–ï¼ˆBox Plotï¼‰â­ æ ¸å¿ƒåˆ†ä½ˆåœ–

**é‡è¦æ€§**ï¼šâ­â­â­â­â­ï¼ˆçµ„åˆ¥åˆ†ææœ€æ ¸å¿ƒçš„åœ–è¡¨ï¼‰

**æ ¸å¿ƒ Insight**ï¼šä¸€çœ¼çœ‹å‡ºå„çµ„çš„è¡¨ç¾åˆ†ä½ˆèˆ‡é›¢ç¾¤å€¼

**åœ–è¡¨è¨­è¨ˆ**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚  Y è»¸ï¼šæ—¥å‡æˆ°åŠŸ (daily_merit)                            â”‚
â”‚  X è»¸ï¼šå„çµ„åˆ¥åç¨±                                        â”‚
â”‚                                                          â”‚
â”‚  æ¯å€‹çµ„åˆ¥é¡¯ç¤ºï¼š                                          â”‚
â”‚  â”œâ”€â”€ ä¸Šé™ç·š (Maximumï¼Œæ’é™¤é›¢ç¾¤å€¼)                        â”‚
â”‚  â”œâ”€â”€ Q3 (ç¬¬ä¸‰å››åˆ†ä½ï¼Œ75th percentile)                    â”‚
â”‚  â”œâ”€â”€ ä¸­ä½æ•¸ç·š (Median) â† æ ¸å¿ƒä½ç½®æŒ‡æ¨™                    â”‚
â”‚  â”œâ”€â”€ Q1 (ç¬¬ä¸€å››åˆ†ä½ï¼Œ25th percentile)                    â”‚
â”‚  â”œâ”€â”€ ä¸‹é™ç·š (Minimumï¼Œæ’é™¤é›¢ç¾¤å€¼)                        â”‚
â”‚  â””â”€â”€ é›¢ç¾¤é» (Outliers) â† æ¨™è¨»æˆå“¡åç¨±                    â”‚
â”‚                                                          â”‚
â”‚  ç›Ÿå¹³å‡æ°´å¹³ç·šï¼ˆè™›ç·šæ©«è·¨å…¨åœ–ï¼‰                            â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¯ç™¼ç¾çš„æ´å¯Ÿ**ï¼š

| è§€å¯Ÿé» | è§£è®€ |
|--------|------|
| ä¸­ä½æ•¸é«˜ä½ | çµ„åˆ¥æ•´é«”æ°´å¹³ |
| ç®±å­é«˜åº¦ (IQR) | çµ„å…§å·®ç•°ç¨‹åº¦ï¼ˆé«˜=ä¸ç©©å®šï¼‰ |
| é›¢ç¾¤é»å‘ä¸Š | æœ‰æ˜æ˜Ÿæˆå“¡ï¼ˆå¯èƒ½éåº¦ä¾è³´ï¼‰ |
| é›¢ç¾¤é»å‘ä¸‹ | æœ‰æ‹–å¾Œè…¿æˆå“¡ï¼ˆéœ€è¦é—œæ³¨ï¼‰ |
| ç®±å­ç›¸å°ç›Ÿå¹³å‡ç·šä½ç½® | å¿«é€Ÿåˆ¤æ–·çµ„åˆ¥æ˜¯å¦é”æ¨™ |

**äº’å‹•åŠŸèƒ½**ï¼š
- Hover ç®±å­ï¼šé¡¯ç¤ºå…·é«”æ•¸å€¼ï¼ˆQ1/Median/Q3/Meanï¼‰
- é»æ“Šé›¢ç¾¤é»ï¼šé¡¯ç¤ºæˆå“¡åç¨±ï¼Œå¯è·³è½‰å€‹äººé 
- æ’åºåˆ‡æ›ï¼šæŒ‰ä¸­ä½æ•¸ / æŒ‰å¹³å‡å€¼ / æŒ‰ç©©å®šæ€§

**æ›¿ä»£æ–¹æ¡ˆ**ï¼šViolin Plotï¼ˆèƒ½æ›´ç²¾ç¢ºå±•ç¤ºåˆ†ä½ˆå½¢æ…‹ï¼Œé©åˆé€²éšç”¨æˆ¶ï¼‰

---

### 3.3 è²¢ç»å±¤ç´šå †ç–Šåœ–ï¼ˆContribution Tier Chartï¼‰â­

**æ ¸å¿ƒ Insight**ï¼šè¦–è¦ºåŒ–çµ„å…§ã€Œéšå±¤çµæ§‹ã€ï¼Œè­˜åˆ¥ä¾è³´å‹çµ„åˆ¥

**è¨­è¨ˆç†å¿µ**ï¼šå°‡æ¯çµ„æˆå“¡ä¾è¡¨ç¾åˆ†ç‚ºä¸‰å€‹å±¤ç´š

| å±¤ç´š | å®šç¾© | å¥åº·ä½”æ¯”åƒè€ƒ |
|------|------|--------------|
| ğŸ† Top 20% | æ ¸å¿ƒæˆå“¡ | æ‡‰è²¢ç» 30-35% |
| ğŸ“Š Middle 60% | ç©©å®šæˆå“¡ | æ‡‰è²¢ç» 50-55% |
| âš ï¸ Bottom 20% | å¾…æå‡æˆå“¡ | æ‡‰è²¢ç» 10-15% |

**åœ–è¡¨å‘ˆç¾**ï¼š100% å †ç–Šæ©«æ¢åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚  ç‹¼ç‹ç‰¹æˆ°: |â–ˆâ–ˆâ–ˆâ–ˆ Top (32%) â–ˆâ–ˆâ–ˆâ–ˆ|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Mid (53%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|â–“â–“ Bot (15%) â–“â–“|
â”‚  å¢¨çµ„:     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Top (40%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|â–ˆâ–ˆâ–ˆâ–ˆ Mid (48%) â–ˆâ–ˆâ–ˆâ–ˆ|â–“â–“ Bot (12%) â–“â–“|
â”‚  éš¼éš¼çµ„:   |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Top (55%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|â–ˆâ–ˆ Mid (38%) â–ˆâ–ˆ|â–“ Bot (7%) â–“|  âš ï¸ ä¾è³´é¢¨éšª
â”‚  æ³¢çµ„:     |â–ˆâ–ˆâ–ˆ Top (28%) â–ˆâ–ˆâ–ˆ|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Mid (52%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|â–“â–“â–“ Bot (20%) â–“â–“â–“|
â”‚                                                          â”‚
â”‚  é¡è‰²ï¼šğŸŸ¢ Top 20% | ğŸŸ¡ Middle 60% | ğŸ”´ Bottom 20%         â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¯ç™¼ç¾çš„æ´å¯Ÿ**ï¼š

| æ¨¡å¼ | è§£è®€ | å»ºè­° |
|------|------|------|
| Top ä½”æ¯” > 50% | åš´é‡ä¾è³´æ ¸å¿ƒæˆå“¡ï¼Œé¢¨éšªé«˜ | éœ€è¦åŸ¹é¤Šä¸­å …åŠ›é‡ |
| Bot ä½”æ¯” > 20% | æœ‰æ˜é¡¯æ‹–å¾Œè…¿æˆå“¡ | éœ€è¦å€‹åˆ¥è¼”å°æˆ–èª¿æ•´ |
| Mid ä½”æ¯”ç©©å®š 55%+ | å¥åº·çš„åœ˜éšŠçµæ§‹ | ç¶­æŒç¾ç‹€ |

**äº’å‹•åŠŸèƒ½**ï¼š
- Hoverï¼šé¡¯ç¤ºè©²å±¤ç´šçš„æˆå“¡åå–®
- é»æ“Šï¼šå±•é–‹è©²å±¤ç´šæˆå“¡è©³æƒ…

---

### 3.4 çµ„åˆ¥å¥åº·åº¦é›·é”åœ–ï¼ˆGroup Health Radarï¼‰

**æ ¸å¿ƒ Insight**ï¼šå¤šç¶­åº¦è©•ä¼°çµ„åˆ¥çš„ã€Œå¥åº·ç¨‹åº¦ã€

**ç¶­åº¦è¨­è¨ˆ**ï¼ˆ5 è»¸ï¼Œ0-100 åˆ†ï¼‰ï¼š

| ç¶­åº¦ | è¨ˆç®—æ–¹å¼ | èªªæ˜ |
|------|----------|------|
| ç¸¾æ•ˆ | ç›¸å°ç›Ÿå¹³å‡çš„ç™¾åˆ†ä½ | è¶Šé«˜è¶Šå¥½ |
| ç©©å®šæ€§ | (1 - CV) Ã— 100 | CV = æ¨™æº–å·®/å¹³å‡å€¼ |
| å‡å‹»åº¦ | (1 - Top30%ä½”æ¯”) Ã— 100 | è¶Šé«˜ä»£è¡¨è²¢ç»è¶Šå‡å‹» |
| æ´»èºåº¦ | æœ‰æ•ˆæ´»èºæˆå“¡æ¯”ä¾‹ Ã— 100 | æ’é™¤æ¥µä½ç”¢å‡ºæˆå“¡ |
| æˆé•·åŠ› | æœ¬æœŸ vs ä¸ŠæœŸå¢é•·ç‡ | æ­£å‘ç‚ºä½³ |

**åœ–è¡¨å‘ˆç¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ç¸¾æ•ˆ                               â”‚
â”‚                        â–²                                 â”‚
â”‚                       /â”‚\                                â”‚
â”‚                      / â”‚ \                               â”‚
â”‚                     /  â”‚  \                              â”‚
â”‚     æˆé•·åŠ› â—„â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”‚â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â–º ç©©å®šæ€§             â”‚
â”‚                     \  â”‚  /                              â”‚
â”‚                      \ â”‚ /                               â”‚
â”‚                       \â”‚/                                â”‚
â”‚                        â–¼                                 â”‚
â”‚         æ´»èºåº¦ â—„â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â–º å‡å‹»åº¦                 â”‚
â”‚                                                          â”‚
â”‚  â”€â”€ ç‹¼ç‹ç‰¹æˆ°ï¼ˆè—è‰²ï¼‰                                     â”‚
â”‚  â”€â”€ å¢¨çµ„ï¼ˆæ©™è‰²ï¼‰                                         â”‚
â”‚  -- ç›Ÿå¹³å‡ï¼ˆç°è‰²è™›ç·šï¼‰                                   â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¯ç™¼ç¾çš„æ´å¯Ÿ**ï¼š
- äº”è§’å½¢è¶Šå¤§è¶Šè¦å‰‡ â†’ çµ„åˆ¥è¶Šå¥åº·
- æŸç¶­åº¦å…§ç¸® â†’ è©²ç¶­åº¦éœ€è¦é—œæ³¨
- èˆ‡ç›Ÿå¹³å‡æ¯”è¼ƒ â†’ è­˜åˆ¥ç›¸å°å„ªåŠ£å‹¢

**äº’å‹•åŠŸèƒ½**ï¼š
- å¤šçµ„ç–ŠåŠ æ¯”è¼ƒï¼ˆæœ€å¤š 3-4 çµ„ + ç›Ÿå¹³å‡ï¼‰
- é»æ“Šç¶­åº¦è»¸ï¼šé¡¯ç¤ºè©²ç¶­åº¦çš„è¨ˆç®—è©³æƒ…

---

### 3.5 çµ„åˆ¥è¶¨å‹¢å°æ¯”åœ–ï¼ˆGroup Trend Comparisonï¼‰

**åœ–è¡¨é¡å‹**ï¼šMulti-line Chart with åŸºæº–ç·š

**è¨­è¨ˆ**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚  Y è»¸ï¼šäººæ—¥å‡æˆ°åŠŸ                                        â”‚
â”‚  X è»¸ï¼šPeriod 1, 2, 3, 4, 5...                          â”‚
â”‚                                                          â”‚
â”‚  å¯¦ç·šï¼šå„çµ„åˆ¥äººæ—¥å‡æˆ°åŠŸè¶¨å‹¢ï¼ˆä¸åŒé¡è‰²ï¼‰                  â”‚
â”‚  è™›ç·šï¼šç›Ÿå¹³å‡æ°´å¹³ï¼ˆä½œç‚ºåŸºæº–ï¼‰                            â”‚
â”‚                                                          â”‚
â”‚  åœ–ä¾‹å€åŸŸï¼š                                              â”‚
â”‚  â— ç‹¼ç‹ç‰¹æˆ° ğŸ“ˆ +8%                                       â”‚
â”‚  â— å¢¨çµ„ ğŸ“‰ -3%                                           â”‚
â”‚  â— éš¼éš¼çµ„ â†”ï¸ +1%                                         â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¶¨å‹¢æŒ‡æ¨™**ï¼š

| æ¨™è¨˜ | æ¢ä»¶ | å«ç¾© |
|------|------|------|
| ğŸ“ˆ | é€£çºŒ 2 æœŸä»¥ä¸Šå¢é•· | ä¸Šå‡è¶¨å‹¢ |
| ğŸ“‰ | é€£çºŒ 2 æœŸä»¥ä¸Šä¸‹é™ | ä¸‹é™è¶¨å‹¢ï¼ˆéœ€é—œæ³¨ï¼‰ |
| â†”ï¸ | ç„¡æ˜é¡¯è¶¨å‹¢ | æ³¢å‹•/æŒå¹³ |

**äº’å‹•åŠŸèƒ½**ï¼š
- Hoverï¼šé«˜äº®è©²çµ„ï¼Œå…¶ä»–æ·¡åŒ–
- åœ–ä¾‹é»æ“Šï¼šåˆ‡æ›é¡¯ç¤º/éš±è—
- ç¯©é¸å™¨ï¼šé è¨­ Top 5ï¼Œå¯æ‰‹å‹•å‹¾é¸

---

### 3.6 æœŸé–“å°æ¯”åœ–ï¼ˆPeriod-over-Period Comparisonï¼‰

**æ ¸å¿ƒ Insight**ï¼šå¿«é€Ÿå°æ¯”ã€Œä¸ŠæœŸ vs æœ¬æœŸã€çš„è®ŠåŒ–

**åœ–è¡¨é¡å‹**ï¼šGrouped Bar Chart with Change Indicator

**è¨­è¨ˆ**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚                   Period 4    Period 5    Change         â”‚
â”‚  ç‹¼ç‹ç‰¹æˆ°: |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| â–² +12%    â”‚
â”‚  å¢¨çµ„:     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|   |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|  â–² +8%     â”‚
â”‚  éš¼éš¼çµ„:   |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ||â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|   â–¼ -3%     â”‚
â”‚  æ³¢çµ„:     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|      |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|      â–² +15%    â”‚
â”‚  ...                                                     â”‚
â”‚                                                          â”‚
â”‚  è™›ç·šæ¨™ç¤ºï¼šç›Ÿå¹³å‡æ°´å¹³                                    â”‚
â”‚                                                          â”‚
â”‚  æ’åºé¸é …ï¼š[æŒ‰æœ¬æœŸè¡¨ç¾ â–¼] [æŒ‰è®ŠåŒ–å¹…åº¦]                   â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é¡è‰²ç·¨ç¢¼**ï¼š
- ğŸŸ¢ ç¶ è‰²ï¼šå¢é•· > 5%
- ğŸŸ¡ é»ƒè‰²ï¼š-5% ~ +5%ï¼ˆæŒå¹³ï¼‰
- ğŸ”´ ç´…è‰²ï¼šä¸‹é™ > 5%

**äº’å‹•åŠŸèƒ½**ï¼š
- é»æ“Šçµ„åˆ¥ â†’ å±•é–‹é¡¯ç¤ºçµ„å…§æˆå“¡è®ŠåŒ–
- æ’åºåˆ‡æ›ï¼šæŒ‰æœ¬æœŸè¡¨ç¾ / æŒ‰è®ŠåŒ–å¹…åº¦

---

### 3.7 æˆå“¡æ’åç†±åŠ›åœ–ï¼ˆMember Rank Heatmapï¼‰

**æ ¸å¿ƒ Insight**ï¼šè¦–è¦ºåŒ–çµ„å…§æ¯å€‹æˆå“¡åœ¨å¤šå€‹ Period çš„æ’åè®ŠåŒ–è»Œè·¡

**åœ–è¡¨é¡å‹**ï¼šHeatmap

**è¨­è¨ˆ**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚             Period 1   Period 2   Period 3   Period 4   â”‚
â”‚  æƒ¡ä¸¨çˆº      ğŸŸ¢ #1     ğŸŸ¢ #1     ğŸŸ¢ #2     ğŸŸ¢ #1        â”‚
â”‚  å–œé¦¬æ‹‰é›…æ˜Ÿ  ğŸŸ¢ #3     ğŸŸ¢ #2     ğŸŸ¢ #1     ğŸŸ¢ #2        â”‚
â”‚  ä¸¨åƒ¥ä¸¨      ğŸŸ¢ #8     ğŸŸ¢ #10    ğŸŸ¡ #15    ğŸŸ¡ #12       â”‚
â”‚  æƒ¡ä¸¨å¤§å‚»    ğŸŸ¢ #5     ğŸŸ¢ #6     ğŸŸ¢ #7     ğŸŸ¢ #6        â”‚
â”‚  æˆå“¡ E      NEW       ğŸŸ¡ #50    ğŸŸ¡ #45    ğŸŸ¡ #42       â”‚
â”‚  æˆå“¡ F      ğŸŸ¡ #45    ğŸŸ¡ #55    ğŸ”´ #80    ğŸ”´ #95       â”‚ âš ï¸
â”‚                                                          â”‚
â”‚  é¡è‰²ç·¨ç¢¼ï¼š                                              â”‚
â”‚  ğŸŸ¢ æ·±ç¶ ï¼šTop 20% (æ’å 1-40)                            â”‚
â”‚  ğŸŸ¡ é»ƒè‰²ï¼šMiddle 60% (æ’å 40-160)                       â”‚
â”‚  ğŸ”´ ç´…è‰²ï¼šBottom 20% (æ’å 160-200)                      â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¯ç™¼ç¾çš„æ´å¯Ÿ**ï¼š

| æ¨¡å¼ | è§£è®€ |
|------|------|
| é¡è‰²ç”±æ·ºè®Šæ·±ï¼ˆå·¦â†’å³ï¼‰ | æˆå“¡åœ¨é€²æ­¥ |
| é¡è‰²ç”±æ·±è®Šæ·ºï¼ˆå·¦â†’å³ï¼‰ | æˆå“¡åœ¨é€€æ­¥ï¼Œéœ€é—œæ³¨ |
| æ•´è¡Œç´…è‰² | é•·æœŸè¡¨ç¾ä¸ä½³çš„æˆå“¡ |
| æ•´è¡Œç¶ è‰² | çµ„å…§æ ¸å¿ƒéª¨å¹¹ |
| NEW æ¨™ç±¤å¾Œå¿«é€Ÿè®Šç¶  | æ–°äººèå…¥è‰¯å¥½ |

**äº’å‹•åŠŸèƒ½**ï¼š
- Hoverï¼šé¡¯ç¤ºå…·é«”æ’åå’Œè®ŠåŒ–ï¼ˆå¦‚ â†‘5, â†“3ï¼‰
- é»æ“Šæˆå“¡ï¼šè·³è½‰åˆ°å€‹äººè©³æƒ…é 
- æ’åºï¼šæŒ‰æœ€æ–°æ’å / æŒ‰é€²æ­¥å¹…åº¦

---

### 3.8 çµ„åˆ¥è²¢ç»ä½”æ¯”è¶¨å‹¢åœ–ï¼ˆGroup Share Trendï¼‰

**æ ¸å¿ƒ Insight**ï¼šè¿½è¹¤å„çµ„å°ç›Ÿç¸½æˆ°åŠŸçš„è²¢ç»æ¯”ä¾‹è®ŠåŒ–

**åœ–è¡¨é¡å‹**ï¼š100% Stacked Area Chart

**è¨­è¨ˆ**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚ 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ â”‚
â”‚     | ç‹¼ç‹ç‰¹æˆ° (18%)  | å¢¨çµ„ (15%) | éš¼éš¼çµ„ (14%) |...  â”‚ â”‚
â”‚  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ â”‚
â”‚     |                                                  â”‚ â”‚
â”‚  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ â”‚
â”‚     |                                                  â”‚ â”‚
â”‚  25%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ â”‚
â”‚     |                   å…¶ä»–çµ„                         â”‚ â”‚
â”‚   0%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ â”‚
â”‚      Period 1   Period 2   Period 3   Period 4         â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¯ç™¼ç¾çš„æ´å¯Ÿ**ï¼š
- æŸçµ„è‰²å¡Šè®Šå¯¬ â†’ è©²çµ„è²¢ç»ä½”æ¯”å¢åŠ ï¼ˆç›¸å°é€²æ­¥ï¼‰
- æŸçµ„è‰²å¡Šè®Šçª„ â†’ è©²çµ„ç›¸å°é€€æ­¥
- è‰²å¡Šé †åºè®ŠåŒ– â†’ çµ„åˆ¥æ’åè®ŠåŒ–
- æ•´é«”ç©©å®š â†’ ç›Ÿå…§ç”Ÿæ…‹å¹³è¡¡

---

### 3.9 çµ„å…§æˆå“¡è¡¨ç¾çŸ©é™£ï¼ˆMember Performance Matrixï¼‰

**éœ€æ±‚è§£è®€**ï¼š
> å°‡è©²çµ„åˆ¥æ‰€æœ‰å€‹äººçš„è³‡æ–™ç–ŠåŠ åœ¨ä¸€èµ·ï¼Œline chartï¼Œæ¯å€‹äººä¸åŒé¡è‰²ï¼Œèª°å¾€ä¸Šèª°å¾€ä¸‹å°±å¾ˆæ¸…æ¥š

**åœ–è¡¨é¡å‹**ï¼šAdaptive Multi-line Chart

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¨­è¨ˆè¦é»ï¼š                                              â”‚
â”‚                                                          â”‚
â”‚  X è»¸ï¼šPeriod                                            â”‚
â”‚  Y è»¸ï¼šæ—¥å‡æˆ°åŠŸ æˆ– è²¢ç»æ’åï¼ˆåè½‰ï¼Œ1 åœ¨ä¸Šï¼‰              â”‚
â”‚  æ¯å€‹æˆå“¡ä¸€æ¢ç·šï¼Œä¸åŒé¡è‰²                                â”‚
â”‚                                                          â”‚
â”‚  æ™ºèƒ½é¡¯ç¤ºç­–ç•¥ï¼š                                          â”‚
â”‚  - é è¨­é¡¯ç¤ºï¼šçµ„å…§ Top 5 + è®ŠåŒ–æœ€å¤§ 5 äºº                   â”‚
â”‚  - å…¶ä»–æˆå“¡å¯æ‰‹å‹•å‹¾é¸                                    â”‚
â”‚                                                          â”‚
â”‚  äº’å‹•è¡Œç‚ºï¼š                                              â”‚
â”‚  - Hover æ™‚é«˜äº®è©²æˆå“¡ç·šæ¢                                â”‚
â”‚  - å…¶ä»–ç·šæ¢æ·¡åŒ– (opacity: 0.2)                           â”‚
â”‚  - é¡¯ç¤ºæˆå“¡åç¨±å’Œæ•¸æ“š                                    â”‚
â”‚                                                          â”‚
â”‚  é¡è‰²ç·¨ç¢¼å»ºè­°ï¼š                                          â”‚
â”‚  - ä½¿ç”¨ 12-16 è‰²èª¿è‰²ç›¤                                   â”‚
â”‚  - é€²æ­¥è€…åæš–è‰²ï¼ˆæ©™ã€ç´…ï¼‰                                â”‚
â”‚  - é€€æ­¥è€…åå†·è‰²ï¼ˆè—ã€ç´«ï¼‰                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.10 çµ„åˆ¥æç»

**çµè«–**ï¼šå®Œå…¨ä¸éœ€è¦ âœ“

---

### 3.11 çµ„åˆ¥åˆ†æåœ–è¡¨å„ªå…ˆç´šç¸½è¦½

| å„ªå…ˆç´š | åœ–è¡¨ | é¡å‹ | æ ¸å¿ƒæ´å¯Ÿ |
|--------|------|------|----------|
| **P1** â­ | çµ„åˆ¥è¡¨ç¾ç®±å½¢åœ– | Box Plot | åˆ†ä½ˆèˆ‡é›¢ç¾¤å€¼ |
| **P1** â­ | è²¢ç»å±¤ç´šå †ç–Šåœ– | Stacked Bar | çµ„å…§éšå±¤çµæ§‹ |
| **P1** â­ | çµ„åˆ¥è¶¨å‹¢å°æ¯” | Line Chart | è·¨æœŸè¶¨å‹¢ |
| **P2** | çµ„åˆ¥å¥åº·åº¦é›·é” | Radar | å¤šç¶­åº¦å¥åº·è©•ä¼° |
| **P2** | æœŸé–“å°æ¯”åœ– | Grouped Bar | ä¸ŠæœŸ vs æœ¬æœŸ |
| **P2** | æˆå“¡æ’åç†±åŠ›åœ– | Heatmap | çµ„å…§å€‹é«”è®ŠåŒ–è»Œè·¡ |
| **P3** | è²¢ç»ä½”æ¯”è¶¨å‹¢ | Stacked Area | çµ„é–“ç”Ÿæ…‹è®ŠåŒ– |
| **P3** | æˆå“¡è¡¨ç¾çŸ©é™£ | Multi-line | çµ„å…§å€‹é«”è©³ç´°è¶¨å‹¢ |

---

## 4. æ•´ç›Ÿå±¤ç´šåˆ†æï¼ˆæ“´å±•ï¼‰

### 4.1 ç›Ÿç´šæŒ‡æ¨™

| æŒ‡æ¨™ | è¨ˆç®—æ–¹å¼ | ç”¨é€” |
|------|----------|------|
| ç›Ÿæˆ°åŠŸç¸½é‡ | `SUM(merit_diff)` | æ•´é«”ç”¢å‡º |
| ç›Ÿäººæ—¥å‡æˆ°åŠŸ | `SUM(merit_diff) / (days * member_count)` | äººå‡æ•ˆç‡ |
| æ´»èºæˆå“¡æ•¸ | æœ¬æœŸæœ‰æ•¸æ“šçš„æˆå“¡æ•¸ | æ´»èºåº¦ |
| æ–°åŠ å…¥æˆå“¡ | `is_new_member = True` çš„æ•¸é‡ | æˆé•·æ€§ |

### 4.2 å»ºè­°åœ–è¡¨

| å ´æ™¯ | åœ–è¡¨é¡å‹ |
|------|----------|
| ç›Ÿæˆ°åŠŸè¶¨å‹¢ | Area Chart / Bar Chart |
| æ´»èºåº¦è®ŠåŒ– | Stacked Bar Chartï¼ˆæ´»èº/æ–°å¢/é›¢é–‹ï¼‰ |
| çµ„åˆ¥å°æ¯” | Grouped Bar Chart |
| Top N æ’è¡Œ | Horizontal Bar Chart / Table |

---

## 5. UI/UX æ¶æ§‹è¨­è¨ˆ

### 5.1 é é¢çµæ§‹

```
Analytics (æ•¸æ“šåˆ†æ)
â”‚
â”œâ”€â”€ ğŸ“Š Overview Dashboardï¼ˆç¸½è¦½å„€è¡¨æ¿ï¼‰
â”‚   â”œâ”€â”€ KPI Cardsï¼ˆé—œéµæŒ‡æ¨™å¡ç‰‡ï¼‰
â”‚   â”‚   â”œâ”€â”€ æœ¬æœŸç›Ÿæˆ°åŠŸç¸½é‡
â”‚   â”‚   â”œâ”€â”€ äººæ—¥å‡æˆ°åŠŸ
â”‚   â”‚   â”œâ”€â”€ æ´»èºæˆå“¡æ•¸
â”‚   â”‚   â””â”€â”€ æ–°åŠ å…¥æˆå“¡æ•¸
â”‚   â”œâ”€â”€ Alliance Merit Trendï¼ˆç›Ÿæˆ°åŠŸè¶¨å‹¢ï¼‰
â”‚   â”œâ”€â”€ Group Comparisonï¼ˆçµ„åˆ¥å°æ¯”ï¼‰
â”‚   â””â”€â”€ Top Performersï¼ˆTop 10 æ’è¡Œï¼‰
â”‚
â”œâ”€â”€ ğŸ‘¤ Member Analyticsï¼ˆå€‹äººåˆ†æï¼‰
â”‚   â”œâ”€â”€ Member Selectorï¼ˆæˆå“¡é¸æ“‡å™¨ï¼‰
â”‚   â”œâ”€â”€ Personal Stats Summaryï¼ˆå€‹äººæ‘˜è¦å¡ç‰‡ï¼‰
â”‚   â”œâ”€â”€ Merit Trend Chartï¼ˆæˆ°åŠŸè¶¨å‹¢ï¼‰
â”‚   â”œâ”€â”€ Comparison Section
â”‚   â”‚   â”œâ”€â”€ vs Alliance Average
â”‚   â”‚   â”œâ”€â”€ vs Group Average
â”‚   â”‚   â””â”€â”€ vs Previous Period
â”‚   â”œâ”€â”€ Multi-dimension Radarï¼ˆå¤šç¶­åº¦é›·é”åœ–ï¼‰
â”‚   â”œâ”€â”€ Rank Historyï¼ˆæ’åæ­·å²ï¼‰
â”‚   â””â”€â”€ Donation Logï¼ˆæç»è¨˜éŒ„ï¼‰
â”‚
â”œâ”€â”€ ğŸ‘¥ Group Analyticsï¼ˆçµ„åˆ¥åˆ†æï¼‰â­ æ·±åº¦è¨­è¨ˆ
â”‚   â”œâ”€â”€ Group Selectorï¼ˆçµ„åˆ¥é¸æ“‡å™¨ï¼‰
â”‚   â”œâ”€â”€ Group Stats Summaryï¼ˆçµ„åˆ¥æ‘˜è¦å¡ç‰‡ Ã— 4ï¼‰
â”‚   â”‚   â”œâ”€â”€ äººæ—¥å‡æˆ°åŠŸ (vs ç›Ÿå¹³å‡)
â”‚   â”‚   â”œâ”€â”€ çµ„å…§äººæ•¸ (vs ä¸ŠæœŸ)
â”‚   â”‚   â”œâ”€â”€ ç©©å®šæ€§æŒ‡æ•¸ (1 - CV)
â”‚   â”‚   â””â”€â”€ è¶¨å‹¢æ–¹å‘ (ğŸ“ˆ/ğŸ“‰/â†”ï¸)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“Š Distribution Sectionï¼ˆåˆ†ä½ˆåˆ†æå€ï¼‰
â”‚   â”‚   â”œâ”€â”€ Box Plot: çµ„åˆ¥è¡¨ç¾åˆ†ä½ˆå°æ¯” â­ P1
â”‚   â”‚   â””â”€â”€ Tier Chart: è²¢ç»å±¤ç´šå †ç–Šåœ– â­ P1
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ˆ Trend Sectionï¼ˆè¶¨å‹¢åˆ†æå€ï¼‰
â”‚   â”‚   â”œâ”€â”€ Line Chart: çµ„åˆ¥è¶¨å‹¢å°æ¯” â­ P1
â”‚   â”‚   â”œâ”€â”€ Grouped Bar: æœŸé–“å°æ¯” (ä¸ŠæœŸ vs æœ¬æœŸ)
â”‚   â”‚   â””â”€â”€ Stacked Area: è²¢ç»ä½”æ¯”è¶¨å‹¢
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ¯ Health Sectionï¼ˆå¥åº·åº¦åˆ†æå€ï¼‰
â”‚   â”‚   â””â”€â”€ Radar Chart: çµ„åˆ¥å¥åº·åº¦é›·é”
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ‘¥ Members Sectionï¼ˆçµ„å…§æˆå“¡å€ï¼‰
â”‚       â”œâ”€â”€ Heatmap: æˆå“¡æ’åè®ŠåŒ–ç†±åŠ›åœ–
â”‚       â”œâ”€â”€ Multi-line: æˆå“¡è¡¨ç¾çŸ©é™£
â”‚       â””â”€â”€ Table: çµ„å…§æˆå“¡åˆ—è¡¨
â”‚
â””â”€â”€ ğŸ“‹ Period Reportsï¼ˆæœŸé–“å ±å‘Šï¼‰
    â”œâ”€â”€ Period Selector
    â”œâ”€â”€ Full Member Ranking Table
    â”œâ”€â”€ Group Summary Cards
    â””â”€â”€ Notable Changesï¼ˆé¡¯è‘—è®ŠåŒ–æ‘˜è¦ï¼‰
```

### 5.2 å°èˆªé‚è¼¯

```
Overview â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€> Member Analytics
               â”‚              â”‚
               â”‚              â–¼
               â”‚         (é»æ“Šæˆå“¡å)
               â”‚
               â””â”€â”€â”€â”€â”€â”€â”€> Group Analytics
                              â”‚
                              â–¼
                         (é»æ“Šçµ„å…§æˆå“¡)
                              â”‚
                              â–¼
                         Member Analytics
```

### 5.3 å…¨å±€æ§åˆ¶é …

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å§‹çµ‚å¯è¦‹çš„æ§åˆ¶é …ï¼š                                      â”‚
â”‚                                                          â”‚
â”‚  [Season Selector â–¼]  [Period Range: â—‹ All â— Custom]    â”‚
â”‚                       [From: Period 1 â–¼] [To: Period 5â–¼] â”‚
â”‚                                                          â”‚
â”‚  Season åˆ‡æ›æ™‚é‡ç½® Period é¸æ“‡                           â”‚
â”‚  Period ç¯„åœå½±éŸ¿æ‰€æœ‰è¶¨å‹¢åœ–è¡¨                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. æŠ€è¡“å¯¦ä½œ

### 6.1 æ–°å¢ API Endpoints

#### å€‹äººåˆ†æ

```
GET /api/v1/analytics/members/{member_id}/trend
  Query:
    - season_id: UUID (required)
    - period_start: int (optional, period_number)
    - period_end: int (optional, period_number)
  Response:
    [{
      period_number: int,
      period_id: UUID,
      start_date: date,
      end_date: date,
      days: int,
      daily_merit: Decimal,
      daily_assist: Decimal,
      daily_contribution: Decimal,
      daily_donation: Decimal,
      end_rank: int,
      rank_change: int | null,
      is_new_member: bool
    }]

GET /api/v1/analytics/members/{member_id}/comparison
  Query:
    - period_id: UUID (required)
  Response:
    {
      personal: {daily_merit, daily_assist, end_rank, ...},
      group_avg: {daily_merit, daily_assist, ...},
      alliance_avg: {daily_merit, daily_assist, ...},
      percentiles: {merit: 85, assist: 72, contribution: 91, ...}
    }
```

#### çµ„åˆ¥åˆ†æ

```
GET /api/v1/analytics/groups
  Query:
    - season_id: UUID (required)
    - period_id: UUID (optional, for specific period stats)
  Response:
    [{
      group_name: str,
      member_count: int,
      daily_merit_per_capita: Decimal,
      daily_assist_per_capita: Decimal,
      total_merit_diff: int
    }]

GET /api/v1/analytics/groups/{group_name}/trend
  Query:
    - season_id: UUID (required)
  Response:
    [{
      period_number: int,
      member_count: int,
      daily_merit_per_capita: Decimal,
      daily_assist_per_capita: Decimal,
      std: Decimal,           // æ–°å¢ï¼šæ¨™æº–å·®
      cv: Decimal             // æ–°å¢ï¼šè®Šç•°ä¿‚æ•¸
    }]

GET /api/v1/analytics/groups/{group_name}/members
  Query:
    - period_id: UUID (required)
  Response:
    [{
      member_id: UUID,
      member_name: str,
      daily_contribution: Decimal,
      daily_merit: Decimal,
      end_rank: int,
      rank_change: int | null
    }]
```

#### çµ„åˆ¥åˆ†ä½ˆåˆ†æï¼ˆæ–°å¢ï¼‰â­

```
GET /api/v1/analytics/groups/{group_name}/distribution
  èªªæ˜ï¼šå–å¾—çµ„åˆ¥çš„åˆ†ä½ˆçµ±è¨ˆè³‡æ–™ï¼ˆBox Plot / å±¤ç´šåˆ†ä½ˆ / å¥åº·åº¦æ‰€éœ€ï¼‰
  Query:
    - period_id: UUID (required)
  Response:
    {
      group_name: str,
      member_count: int,

      // Box Plot æ•¸æ“š
      daily_merit_distribution: {
        min: Decimal,
        q1: Decimal,
        median: Decimal,
        q3: Decimal,
        max: Decimal,
        mean: Decimal,
        std: Decimal,
        cv: Decimal,           // è®Šç•°ä¿‚æ•¸ = std / mean
        iqr: Decimal,          // å››åˆ†ä½è· = Q3 - Q1
        outliers_high: [{member_id, member_name, value}],
        outliers_low: [{member_id, member_name, value}]
      },

      // å±¤ç´šåˆ†ä½ˆï¼ˆTier Chart æ‰€éœ€ï¼‰
      tier_distribution: {
        top_20_pct: {
          count: int,
          total_merit: int,
          share: Decimal,      // ä½”çµ„ç¸½æˆ°åŠŸæ¯”ä¾‹ (0-1)
          members: [{member_id, member_name, daily_merit}]
        },
        mid_60_pct: {...},
        bot_20_pct: {...}
      },

      // å¥åº·åº¦è©•åˆ†ï¼ˆRadar Chart æ‰€éœ€ï¼‰
      health_scores: {
        performance: int,      // 0-100ï¼Œç›¸å°ç›Ÿå¹³å‡çš„ç™¾åˆ†ä½
        stability: int,        // 0-100ï¼Œ(1 - CV) * 100
        uniformity: int,       // 0-100ï¼Œ(1 - top30%ä½”æ¯”) * 100
        activity: int,         // 0-100ï¼Œæ´»èºæˆå“¡æ¯”ä¾‹
        growth: int            // 0-100ï¼Œç›¸æ¯”ä¸ŠæœŸå¢é•·ç‡ï¼ˆæ¨™æº–åŒ–ï¼‰
      }
    }

GET /api/v1/analytics/groups/comparison
  èªªæ˜ï¼šå–å¾—æ‰€æœ‰çµ„åˆ¥çš„ Box Plot å°æ¯”æ•¸æ“šï¼ˆå–®ä¸€æœŸé–“ï¼‰
  Query:
    - period_id: UUID (required)
  Response:
    [{
      group_name: str,
      member_count: int,
      daily_merit: {
        min: Decimal,
        q1: Decimal,
        median: Decimal,
        q3: Decimal,
        max: Decimal,
        outliers: [{member_id, member_name, value}]
      }
    }]

GET /api/v1/analytics/groups/share-trend
  èªªæ˜ï¼šå–å¾—å„çµ„åˆ¥ä½”ç›Ÿç¸½æˆ°åŠŸçš„æ¯”ä¾‹è¶¨å‹¢ï¼ˆStacked Area Chart æ‰€éœ€ï¼‰
  Query:
    - season_id: UUID (required)
  Response:
    [{
      period_number: int,
      groups: [{
        group_name: str,
        total_merit_diff: int,
        share: Decimal         // ä½”ç›Ÿç¸½æˆ°åŠŸæ¯”ä¾‹ (0-1)
      }]
    }]

GET /api/v1/analytics/groups/{group_name}/member-ranks
  èªªæ˜ï¼šå–å¾—çµ„å…§æˆå“¡çš„æ’åæ­·å²çŸ©é™£ï¼ˆHeatmap æ‰€éœ€ï¼‰
  Query:
    - season_id: UUID (required)
  Response:
    {
      periods: [{period_number, period_id}],
      members: [{
        member_id: UUID,
        member_name: str,
        ranks: [
          {period_number: 1, rank: 15, rank_change: null, is_new: true},
          {period_number: 2, rank: 12, rank_change: -3, is_new: false},
          ...
        ]
      }],
      total_members: int       // ç›Ÿç¸½äººæ•¸ï¼Œç”¨æ–¼è¨ˆç®—ç™¾åˆ†ä½
    }
```

#### æ•´ç›Ÿåˆ†æ

```
GET /api/v1/analytics/alliance/summary
  Query:
    - season_id: UUID (required)
    - period_id: UUID (optional)
  Response:
    {
      total_members: int,
      active_members: int,
      new_members: int,
      total_merit_diff: int,
      avg_daily_merit: Decimal
    }

GET /api/v1/analytics/alliance/trend
  Query:
    - season_id: UUID (required)
  Response:
    [{
      period_number: int,
      member_count: int,
      total_merit_diff: int,
      avg_daily_merit: Decimal
    }]

GET /api/v1/analytics/alliance/leaderboard
  Query:
    - period_id: UUID (required)
    - metric: str (merit | contribution | assist)
    - limit: int (default: 10)
  Response:
    [{
      rank: int,
      member_id: UUID,
      member_name: str,
      value: Decimal,
      change: int | null (æ’åè®ŠåŒ–)
    }]
```

### 6.2 å‰ç«¯åœ–è¡¨çµ„ä»¶

**ä½¿ç”¨ Rechartsï¼ˆå·²å®‰è£ v2.15.4ï¼‰**

```typescript
// å»ºè­°çš„çµ„ä»¶çµæ§‹
src/components/analytics/
â”œâ”€â”€ charts/
â”‚   â”‚
â”‚   â”‚  // å€‹äººåˆ†æåœ–è¡¨
â”‚   â”œâ”€â”€ MeritTrendChart.tsx        // æˆ°åŠŸè¶¨å‹¢ï¼ˆLineï¼‰
â”‚   â”œâ”€â”€ RankHistoryChart.tsx       // æ’åæ­·å²ï¼ˆInverted Lineï¼‰
â”‚   â”œâ”€â”€ ComparisonRadar.tsx        // å¤šç¶­åº¦æ¯”è¼ƒï¼ˆRadarï¼‰
â”‚   â”œâ”€â”€ DonationBarChart.tsx       // æç»è¨˜éŒ„ï¼ˆBarï¼‰
â”‚   â”‚
â”‚   â”‚  // çµ„åˆ¥åˆ†æåœ–è¡¨ï¼ˆæ–°å¢ï¼‰â­
â”‚   â”œâ”€â”€ GroupBoxPlot.tsx           // çµ„åˆ¥è¡¨ç¾åˆ†ä½ˆï¼ˆBox Plotï¼‰â­ P1
â”‚   â”œâ”€â”€ TierDistributionChart.tsx  // è²¢ç»å±¤ç´šå †ç–Šï¼ˆStacked Barï¼‰â­ P1
â”‚   â”œâ”€â”€ GroupTrendChart.tsx        // çµ„åˆ¥è¶¨å‹¢å°æ¯”ï¼ˆMulti-lineï¼‰â­ P1
â”‚   â”œâ”€â”€ GroupHealthRadar.tsx       // çµ„åˆ¥å¥åº·åº¦é›·é”ï¼ˆRadarï¼‰
â”‚   â”œâ”€â”€ PeriodComparisonBar.tsx    // æœŸé–“å°æ¯”ï¼ˆGrouped Barï¼‰
â”‚   â”œâ”€â”€ MemberRankHeatmap.tsx      // æˆå“¡æ’åç†±åŠ›åœ–ï¼ˆHeatmapï¼‰
â”‚   â”œâ”€â”€ GroupShareTrend.tsx        // è²¢ç»ä½”æ¯”è¶¨å‹¢ï¼ˆStacked Areaï¼‰
â”‚   â””â”€â”€ MemberMatrixChart.tsx      // æˆå“¡è¡¨ç¾çŸ©é™£ï¼ˆMulti-lineï¼‰
â”‚
â”œâ”€â”€ cards/
â”‚   â”œâ”€â”€ KpiCard.tsx                // é—œéµæŒ‡æ¨™å¡ç‰‡
â”‚   â”œâ”€â”€ StatsSummaryCard.tsx       // çµ±è¨ˆæ‘˜è¦å¡ç‰‡
â”‚   â””â”€â”€ GroupStatsCard.tsx         // çµ„åˆ¥æ‘˜è¦å¡ç‰‡ï¼ˆæ–°å¢ï¼‰
â”‚
â””â”€â”€ selectors/
    â”œâ”€â”€ MemberSelector.tsx         // æˆå“¡é¸æ“‡å™¨
    â”œâ”€â”€ GroupSelector.tsx          // çµ„åˆ¥é¸æ“‡å™¨
    â””â”€â”€ PeriodRangeSelector.tsx    // æœŸé–“ç¯„åœé¸æ“‡å™¨
```

### 6.3 TanStack Query Hooks

```typescript
// hooks/queries/useAnalytics.ts

export const analyticsKeys = {
  all: ['analytics'] as const,

  // å€‹äººåˆ†æ
  memberTrend: (memberId: string, seasonId: string) =>
    [...analyticsKeys.all, 'member', memberId, 'trend', seasonId] as const,
  memberComparison: (memberId: string, periodId: string) =>
    [...analyticsKeys.all, 'member', memberId, 'comparison', periodId] as const,

  // çµ„åˆ¥åˆ†æï¼ˆæ–°å¢ï¼‰â­
  groupList: (seasonId: string, periodId?: string) =>
    [...analyticsKeys.all, 'groups', seasonId, periodId] as const,
  groupTrend: (groupName: string, seasonId: string) =>
    [...analyticsKeys.all, 'group', groupName, 'trend', seasonId] as const,
  groupDistribution: (groupName: string, periodId: string) =>
    [...analyticsKeys.all, 'group', groupName, 'distribution', periodId] as const,
  groupComparison: (periodId: string) =>
    [...analyticsKeys.all, 'groups', 'comparison', periodId] as const,
  groupShareTrend: (seasonId: string) =>
    [...analyticsKeys.all, 'groups', 'share-trend', seasonId] as const,
  groupMemberRanks: (groupName: string, seasonId: string) =>
    [...analyticsKeys.all, 'group', groupName, 'member-ranks', seasonId] as const,
  groupMembers: (groupName: string, periodId: string) =>
    [...analyticsKeys.all, 'group', groupName, 'members', periodId] as const,

  // æ•´ç›Ÿåˆ†æ
  allianceSummary: (seasonId: string) =>
    [...analyticsKeys.all, 'alliance', 'summary', seasonId] as const,
  leaderboard: (periodId: string, metric: string) =>
    [...analyticsKeys.all, 'leaderboard', periodId, metric] as const,
}

// Example hooks

// å€‹äººè¶¨å‹¢
export function useMemberTrend(memberId: string, seasonId: string) {
  return useQuery({
    queryKey: analyticsKeys.memberTrend(memberId, seasonId),
    queryFn: () => apiClient.get(`/analytics/members/${memberId}/trend`, {
      params: { season_id: seasonId }
    }),
    enabled: !!memberId && !!seasonId,
  })
}

// çµ„åˆ¥åˆ†ä½ˆçµ±è¨ˆï¼ˆBox Plot / Tier Chart / Health Radar æ‰€éœ€ï¼‰â­
export function useGroupDistribution(groupName: string, periodId: string) {
  return useQuery({
    queryKey: analyticsKeys.groupDistribution(groupName, periodId),
    queryFn: () => apiClient.get(`/analytics/groups/${encodeURIComponent(groupName)}/distribution`, {
      params: { period_id: periodId }
    }),
    enabled: !!groupName && !!periodId,
  })
}

// æ‰€æœ‰çµ„åˆ¥ Box Plot å°æ¯”
export function useGroupComparison(periodId: string) {
  return useQuery({
    queryKey: analyticsKeys.groupComparison(periodId),
    queryFn: () => apiClient.get('/analytics/groups/comparison', {
      params: { period_id: periodId }
    }),
    enabled: !!periodId,
  })
}

// çµ„åˆ¥è²¢ç»ä½”æ¯”è¶¨å‹¢
export function useGroupShareTrend(seasonId: string) {
  return useQuery({
    queryKey: analyticsKeys.groupShareTrend(seasonId),
    queryFn: () => apiClient.get('/analytics/groups/share-trend', {
      params: { season_id: seasonId }
    }),
    enabled: !!seasonId,
  })
}

// çµ„å…§æˆå“¡æ’åæ­·å²ï¼ˆHeatmap æ‰€éœ€ï¼‰
export function useGroupMemberRanks(groupName: string, seasonId: string) {
  return useQuery({
    queryKey: analyticsKeys.groupMemberRanks(groupName, seasonId),
    queryFn: () => apiClient.get(`/analytics/groups/${encodeURIComponent(groupName)}/member-ranks`, {
      params: { season_id: seasonId }
    }),
    enabled: !!groupName && !!seasonId,
  })
}
```

---

## 7. å¯¦ä½œå„ªå…ˆç´š

### Phase 1: åŸºç¤å€‹äººåˆ†æï¼ˆæ ¸å¿ƒåƒ¹å€¼ï¼‰â­

| å„ªå…ˆç´š | é …ç›® | åœ–è¡¨é¡å‹ | é ä¼°è¤‡é›œåº¦ |
|--------|------|----------|-----------|
| P1.1 | æˆ°åŠŸæ—¥å‡è¶¨å‹¢åœ– | Line Chart | ä¸­ |
| P1.2 | è²¢ç»æ’åæ­·å² | Inverted Line | ä½ |
| P1.3 | å€‹äºº vs ç›Ÿå¹³å‡æ¯”è¼ƒ | Dual-axis Line | ä¸­ |

### Phase 2: çµ„åˆ¥åˆ†æ - æ ¸å¿ƒåœ–è¡¨ï¼ˆåˆ†ä½ˆæ¦‚å¿µï¼‰â­â­

> **è¨­è¨ˆç†å¿µ**ï¼šçµ„åˆ¥åˆ†æçš„æ ¸å¿ƒåƒ¹å€¼åœ¨æ–¼ã€Œåˆ†ä½ˆã€èˆ‡ã€Œçµæ§‹å¥åº·åº¦ã€ï¼Œé€™æ˜¯å€‹äººåˆ†ææ²’æœ‰çš„ç¶­åº¦ã€‚

| å„ªå…ˆç´š | é …ç›® | åœ–è¡¨é¡å‹ | æ ¸å¿ƒæ´å¯Ÿ | é ä¼°è¤‡é›œåº¦ |
|--------|------|----------|----------|-----------|
| **P2.1** â­ | çµ„åˆ¥è¡¨ç¾ç®±å½¢åœ– | Box Plot | åˆ†ä½ˆèˆ‡é›¢ç¾¤å€¼ | é«˜ï¼ˆéœ€è‡ªè¨‚çµ„ä»¶ï¼‰|
| **P2.2** â­ | è²¢ç»å±¤ç´šå †ç–Šåœ– | 100% Stacked Bar | çµ„å…§éšå±¤çµæ§‹ | ä¸­ |
| **P2.3** â­ | çµ„åˆ¥è¶¨å‹¢å°æ¯” | Multi-line Chart | è·¨æœŸè¶¨å‹¢ | ä¸­ |
| P2.4 | æœŸé–“å°æ¯”åœ– | Grouped Bar | ä¸ŠæœŸ vs æœ¬æœŸ | ä½ |

### Phase 3: çµ„åˆ¥åˆ†æ - é€²éšåœ–è¡¨

| å„ªå…ˆç´š | é …ç›® | åœ–è¡¨é¡å‹ | æ ¸å¿ƒæ´å¯Ÿ | é ä¼°è¤‡é›œåº¦ |
|--------|------|----------|----------|-----------|
| P3.1 | çµ„åˆ¥å¥åº·åº¦é›·é” | Radar Chart | å¤šç¶­åº¦å¥åº·è©•ä¼° | ä¸­ |
| P3.2 | æˆå“¡æ’åç†±åŠ›åœ– | Heatmap | çµ„å…§å€‹é«”è®ŠåŒ–è»Œè·¡ | é«˜ï¼ˆéœ€è‡ªè¨‚çµ„ä»¶ï¼‰|
| P3.3 | è²¢ç»ä½”æ¯”è¶¨å‹¢ | Stacked Area | çµ„é–“ç”Ÿæ…‹è®ŠåŒ– | ä¸­ |
| P3.4 | æˆå“¡è¡¨ç¾çŸ©é™£ | Multi-line | çµ„å…§å€‹é«”è©³ç´°è¶¨å‹¢ | é«˜ |

### Phase 4: å€‹äººé€²éšæ¯”è¼ƒ & å…¶ä»–

| å„ªå…ˆç´š | é …ç›® | åœ–è¡¨é¡å‹ | é ä¼°è¤‡é›œåº¦ |
|--------|------|----------|-----------|
| P4.1 | å€‹äººå¤šç¶­åº¦ Radar | Radar Chart | ä¸­ |
| P4.2 | åŠ©æ”»åˆ†æ | è¤‡ç”¨æˆ°åŠŸé‚è¼¯ | ä½ |
| P4.3 | æç»è¨˜éŒ„ | Bar Chart | ä½ |

### Phase 5: æ•´ç›Ÿ Dashboard

| å„ªå…ˆç´š | é …ç›® | åœ–è¡¨é¡å‹ | é ä¼°è¤‡é›œåº¦ |
|--------|------|----------|-----------|
| P5.1 | ç¸½è¦½ KPI å¡ç‰‡ | Cards | ä½ |
| P5.2 | Top Performers | Table/Bar | ä½ |
| P5.3 | æ´»èºåº¦åˆ†æ | Stacked Bar | ä¸­ |

---

## 8. è¨­è¨ˆåŸå‰‡

### 8.1 æ•¸æ“šé©…å‹•

- æ‰€æœ‰åœ–è¡¨åŸºæ–¼ `MemberPeriodMetrics` è¡¨
- é¿å…åœ¨å‰ç«¯é€²è¡Œè¤‡é›œè¨ˆç®—ï¼Œç”±å¾Œç«¯ API æä¾›è¨ˆç®—çµæœ
- ä½¿ç”¨ Decimal ä¿æŒç²¾åº¦

### 8.2 æ¼¸é€²æ­éœ²

- å¾ç°¡å–®è¶¨å‹¢é–‹å§‹ï¼Œå†åˆ°è¤‡é›œæ¯”è¼ƒ
- é è¨­é¡¯ç¤ºæœ€ç›¸é—œçš„æ•¸æ“šï¼Œé€²éšé¸é …å¯æ‘ºç–Š
- æä¾›ã€Œæ·±å…¥æ¢ç´¢ã€å…¥å£

### 8.3 ä¸Šä¸‹æ–‡æ„ŸçŸ¥

- ä»»ä½•æ•¸æ“šé»éƒ½æ‡‰èƒ½é‘½å–åˆ°è©³æƒ…
- ä¿æŒç•¶å‰ç¯©é¸æ¢ä»¶åœ¨é é¢åˆ‡æ›æ™‚çš„é€£çºŒæ€§
- æä¾›éºµåŒ…å±‘å°èˆª

### 8.4 æ•ˆèƒ½è€ƒé‡

- å¤§æ•¸æ“šé‡æ™‚ä½¿ç”¨åˆ†é /èšåˆ
- åœ–è¡¨æ•¸æ“šé»éå¤šæ™‚è‡ªå‹•æ¡æ¨£
- ä½¿ç”¨ React Query é€²è¡Œç·©å­˜ç®¡ç†

### 8.5 è¦–è¦ºä¸€è‡´æ€§

- é…è‰²æ–¹æ¡ˆçµ±ä¸€ï¼ˆä½¿ç”¨é …ç›® CSS è®Šæ•¸ï¼‰
- äº¤äº’è¡Œç‚ºçµ±ä¸€ï¼ˆHover/Click/Selectï¼‰
- æ•¸å€¼æ ¼å¼çµ±ä¸€ï¼ˆå°æ•¸ä½ã€åƒåˆ†ä½ï¼‰

---

## 9. åœ–è¡¨æŠ€è¡“é¸å‹æ‘˜è¦

### 9.1 å€‹äººåˆ†æåœ–è¡¨

| å ´æ™¯ | åœ–è¡¨é¡å‹ | å·¥å…· | ç†ç”± |
|------|----------|------|------|
| å–®æŒ‡æ¨™è¶¨å‹¢ | Line Chart | Recharts `<LineChart>` | é€£çºŒè®ŠåŒ–æ¸…æ™° |
| æ’åè®ŠåŒ– | Inverted Line | Recharts `<LineChart>` + reversed Y | 1=æœ€å¥½åœ¨ä¸Šæ–¹ |
| å¤šç¶­åº¦å°æ¯” | Radar Chart | Recharts `<RadarChart>` | ç›´è§€å½¢ç‹€æ¯”è¼ƒ |
| ç°¡å–®è¨˜éŒ„ | Bar Chart | Recharts `<BarChart>` | ç°¡æ½”æ˜ç­ |

### 9.2 çµ„åˆ¥åˆ†æåœ–è¡¨ï¼ˆæ–°å¢ï¼‰â­

| å ´æ™¯ | åœ–è¡¨é¡å‹ | å·¥å…· | ç†ç”± |
|------|----------|------|------|
| åˆ†ä½ˆå°æ¯” â­ | Box Plot | è‡ªè¨‚çµ„ä»¶ + Recharts | ä¸€çœ¼çœ‹å‡ºåˆ†ä½ˆèˆ‡é›¢ç¾¤å€¼ |
| å±¤ç´šçµæ§‹ â­ | 100% Stacked Bar | Recharts `<BarChart stackOffset="expand">` | è¦–è¦ºåŒ–ä½”æ¯”çµæ§‹ |
| çµ„åˆ¥è¶¨å‹¢ â­ | Multi-line | Recharts `<LineChart>` | å¤šçµ„å°æ¯”æ¸…æ™° |
| å¥åº·åº¦è©•ä¼° | Radar Chart | Recharts `<RadarChart>` | å¤šç¶­åº¦è©•åˆ†ç›´è§€ |
| æœŸé–“å°æ¯” | Grouped Bar | Recharts `<BarChart>` | ä¸ŠæœŸ vs æœ¬æœŸæ¯”è¼ƒ |
| æ’åè»Œè·¡ | Heatmap | è‡ªè¨‚çµ„ä»¶ | çŸ©é™£å¼è®ŠåŒ–è¦–è¦ºåŒ– |
| ä½”æ¯”è¶¨å‹¢ | Stacked Area | Recharts `<AreaChart stackOffset="expand">` | æ¯”ä¾‹è®ŠåŒ–æ¸…æ™° |
| çµ„å…§æˆå“¡ | Multi-line | Recharts `<LineChart>` | è­˜åˆ¥é€²é€€æ­¥è€… |

### 9.3 æ•´ç›Ÿåˆ†æåœ–è¡¨

| å ´æ™¯ | åœ–è¡¨é¡å‹ | å·¥å…· | ç†ç”± |
|------|----------|------|------|
| æ•¸å€¼å°æ¯” | Grouped Bar | Recharts `<BarChart>` | ç²¾ç¢ºæ•¸å€¼æ¯”è¼ƒ |
| ç´¯ç©è¶¨å‹¢ | Area Chart | Recharts `<AreaChart>` | å¼·èª¿ç´¯ç©æ•ˆæœ |
| æ’è¡Œæ¦œ | Horizontal Bar | Recharts `<BarChart layout="vertical">` | åç¨±ç©ºé–“å……è¶³ |

### 9.4 è‡ªè¨‚çµ„ä»¶èªªæ˜

**Box Plotï¼ˆç®±å½¢åœ–ï¼‰**ï¼š
- Recharts åŸç”Ÿä¸æ”¯æ´ Box Plot
- éœ€è‡ªè¨‚ `<GroupBoxPlot>` çµ„ä»¶
- ä½¿ç”¨ `<ComposedChart>` + è‡ªè¨‚ Shape
- åƒè€ƒï¼š[Recharts Custom Shape](https://recharts.org/en-US/examples/CustomContentTreemap)

**Heatmapï¼ˆç†±åŠ›åœ–ï¼‰**ï¼š
- Recharts åŸç”Ÿä¸æ”¯æ´ Heatmap
- é¸é … 1ï¼šä½¿ç”¨ CSS Grid + æ¢ä»¶æ¨£å¼
- é¸é … 2ï¼šä½¿ç”¨ `react-heatmap-grid` æˆ– `nivo`
- é¸é … 3ï¼šè‡ªè¨‚ SVG çµ„ä»¶

---

## Appendix A: ç¯„ä¾‹æ•¸æ“šçµæ§‹

### A.1 æˆå“¡è¶¨å‹¢ API Response

```json
[
  {
    "period_number": 1,
    "period_id": "uuid-1",
    "start_date": "2025-01-01",
    "end_date": "2025-01-08",
    "days": 7,
    "daily_merit": 15000.50,
    "daily_assist": 50.25,
    "daily_contribution": 150000.00,
    "daily_donation": 1000.00,
    "end_rank": 48,
    "rank_change": null,
    "is_new_member": true
  },
  {
    "period_number": 2,
    "period_id": "uuid-2",
    "start_date": "2025-01-08",
    "end_date": "2025-01-15",
    "days": 7,
    "daily_merit": 18500.75,
    "daily_assist": 65.00,
    "daily_contribution": 175000.00,
    "daily_donation": 500.00,
    "end_rank": 42,
    "rank_change": -6,
    "is_new_member": false
  }
]
```

### A.2 çµ„åˆ¥æ¯”è¼ƒ API Response

```json
[
  {
    "group_name": "ç‹¼ç‹ç‰¹æˆ°",
    "member_count": 33,
    "daily_merit_per_capita": 18500.00,
    "daily_assist_per_capita": 55.50,
    "total_merit_diff": 4268500
  },
  {
    "group_name": "å¢¨çµ„",
    "member_count": 25,
    "daily_merit_per_capita": 16800.00,
    "daily_assist_per_capita": 48.20,
    "total_merit_diff": 2940000
  }
]
```

### A.3 çµ„åˆ¥åˆ†ä½ˆçµ±è¨ˆ API Responseï¼ˆæ–°å¢ï¼‰â­

```json
{
  "group_name": "ç‹¼ç‹ç‰¹æˆ°",
  "member_count": 33,

  "daily_merit_distribution": {
    "min": 5200.50,
    "q1": 12000.00,
    "median": 18500.00,
    "q3": 28000.00,
    "max": 45000.00,
    "mean": 19500.00,
    "std": 9800.00,
    "cv": 0.50,
    "iqr": 16000.00,
    "outliers_high": [
      {"member_id": "uuid-1", "member_name": "æƒ¡ä¸¨çˆº", "value": 45000.00}
    ],
    "outliers_low": [
      {"member_id": "uuid-2", "member_name": "æ–°äººA", "value": 5200.50}
    ]
  },

  "tier_distribution": {
    "top_20_pct": {
      "count": 7,
      "total_merit": 245000,
      "share": 0.32,
      "members": [
        {"member_id": "uuid-1", "member_name": "æƒ¡ä¸¨çˆº", "daily_merit": 45000.00},
        {"member_id": "uuid-3", "member_name": "å–œé¦¬æ‹‰é›…æ˜Ÿ", "daily_merit": 38000.00}
      ]
    },
    "mid_60_pct": {
      "count": 20,
      "total_merit": 420000,
      "share": 0.55,
      "members": []
    },
    "bot_20_pct": {
      "count": 6,
      "total_merit": 98000,
      "share": 0.13,
      "members": []
    }
  },

  "health_scores": {
    "performance": 85,
    "stability": 50,
    "uniformity": 68,
    "activity": 95,
    "growth": 72
  }
}
```

### A.4 çµ„é–“ Box Plot å°æ¯” API Responseï¼ˆæ–°å¢ï¼‰

```json
[
  {
    "group_name": "ç‹¼ç‹ç‰¹æˆ°",
    "member_count": 33,
    "daily_merit": {
      "min": 8500.00,
      "q1": 12000.00,
      "median": 18500.00,
      "q3": 28000.00,
      "max": 38000.00,
      "outliers": [
        {"member_id": "uuid-1", "member_name": "æƒ¡ä¸¨çˆº", "value": 45000.00}
      ]
    }
  },
  {
    "group_name": "å¢¨çµ„",
    "member_count": 25,
    "daily_merit": {
      "min": 6800.00,
      "q1": 10500.00,
      "median": 16800.00,
      "q3": 24000.00,
      "max": 35000.00,
      "outliers": []
    }
  },
  {
    "group_name": "éš¼éš¼çµ„",
    "member_count": 27,
    "daily_merit": {
      "min": 5500.00,
      "q1": 9000.00,
      "median": 14500.00,
      "q3": 22000.00,
      "max": 32000.00,
      "outliers": [
        {"member_id": "uuid-5", "member_name": "ç¿Šä¸¨è¤ªè‰²è€…", "value": 38000.00}
      ]
    }
  }
]
```

### A.5 çµ„å…§æˆå“¡æ’åæ­·å² API Responseï¼ˆæ–°å¢ï¼‰

```json
{
  "periods": [
    {"period_number": 1, "period_id": "uuid-p1"},
    {"period_number": 2, "period_id": "uuid-p2"},
    {"period_number": 3, "period_id": "uuid-p3"},
    {"period_number": 4, "period_id": "uuid-p4"}
  ],
  "members": [
    {
      "member_id": "uuid-m1",
      "member_name": "æƒ¡ä¸¨çˆº",
      "ranks": [
        {"period_number": 1, "rank": 1, "rank_change": null, "is_new": false},
        {"period_number": 2, "rank": 1, "rank_change": 0, "is_new": false},
        {"period_number": 3, "rank": 2, "rank_change": 1, "is_new": false},
        {"period_number": 4, "rank": 1, "rank_change": -1, "is_new": false}
      ]
    },
    {
      "member_id": "uuid-m2",
      "member_name": "å–œé¦¬æ‹‰é›…æ˜Ÿ",
      "ranks": [
        {"period_number": 1, "rank": 3, "rank_change": null, "is_new": false},
        {"period_number": 2, "rank": 2, "rank_change": -1, "is_new": false},
        {"period_number": 3, "rank": 1, "rank_change": -1, "is_new": false},
        {"period_number": 4, "rank": 2, "rank_change": 1, "is_new": false}
      ]
    },
    {
      "member_id": "uuid-m3",
      "member_name": "æ–°äººå°ç™½",
      "ranks": [
        {"period_number": 1, "rank": null, "rank_change": null, "is_new": false},
        {"period_number": 2, "rank": null, "rank_change": null, "is_new": false},
        {"period_number": 3, "rank": 55, "rank_change": null, "is_new": true},
        {"period_number": 4, "rank": 48, "rank_change": -7, "is_new": false}
      ]
    }
  ],
  "total_members": 199
}
```

---

## 10. å¯¦ä½œé€²åº¦è¿½è¹¤

### 10.1 æˆå“¡è¡¨ç¾é é¢ï¼ˆMemberPerformanceï¼‰

**ç‹€æ…‹**: âœ… **å·²å®Œæˆ** - å‰å¾Œç«¯æ•´åˆå®Œç•¢

**æª”æ¡ˆä½ç½®**: `frontend/src/pages/MemberPerformance.tsx` (1465 è¡Œ)

#### Tab çµæ§‹

| Tab | åç¨± | å…§å®¹ | ç‹€æ…‹ |
|-----|------|------|------|
| 1 | ç¸½è¦½ | è²¢ç»æ’åï¼ˆå®˜æ–¹ç¶œåˆæŒ‡æ¨™ï¼‰ã€æ’åè¶¨å‹¢ã€å››ç¶­é›·é”åœ– | âœ… å·²å®Œæˆ |
| 2 | æˆ°åŠŸèˆ‡åŠ©æ”» | æ—¥å‡æˆ°åŠŸè¶¨å‹¢ï¼ˆä¸»è¦ï¼‰ã€åŠ©æ”»è¶¨å‹¢ï¼ˆæ¬¡è¦ï¼‰ | âœ… å·²å®Œæˆ |
| 3 | å‹¢åŠ›å€¼èˆ‡æç» | å‹¢åŠ›å€¼è¶¨å‹¢ã€æç»è¶¨å‹¢ã€æœŸé–“æ˜ç´°è¡¨ | âœ… å·²å®Œæˆ |

#### é—œéµè¨­è¨ˆæ±ºç­–ï¼šæ—¥æœŸ X è»¸

**éœ€æ±‚**: åœ–è¡¨ X è»¸ä½¿ç”¨å¯¦éš›æ—¥æœŸï¼Œæ¯å€‹ period çš„æ•¸æ“šå±•é–‹åˆ°è©²æœŸé–“çš„æ¯ä¸€å¤©ã€‚

**å¯¦ä½œæ–¹å¼**:

```typescript
// å°‡ period æ•¸æ“šå±•é–‹ç‚ºæ¯æ—¥æ•¸æ“šé»
function expandPeriodsToDaily(periods: PeriodData[]): DailyDataPoint[]

// ä¾‹å¦‚ Period 1ï¼ˆ10/02-10/09ï¼‰æ—¥å‡æˆ°åŠŸ 9500
// å±•é–‹å¾Œ:
// 10/02 â†’ 9500
// 10/03 â†’ 9500
// ...
// 10/08 â†’ 9500 (å…± 7 å¤©ç›¸åŒæ•¸æ“š)
```

**åœ–è¡¨å‘ˆç¾**:
- ä½¿ç”¨ `type="stepAfter"` å‘ˆç¾éšæ¢¯ç‹€æ›²ç·š
- X è»¸ ticks åªé¡¯ç¤º period é‚Šç•Œæ—¥æœŸ
- Tooltip é¡¯ç¤ºï¼šæ—¥æœŸ + Period ç·¨è™Ÿ + æ•¸æ“š

**æ•¸æ“šçµæ§‹**:

```typescript
interface PeriodData {
  period_number: number
  period_label: string
  start_date: string  // ISO date: "2024-10-02"
  end_date: string    // ISO date: "2024-10-09"
  days: number
  daily_merit: number
  daily_assist: number
  // ... å…¶ä»–æ¬„ä½
}

interface DailyDataPoint {
  date: string        // ISO date
  dateLabel: string   // "10/2" é¡¯ç¤ºæ ¼å¼
  periodNumber: number
  dailyMerit: number
  dailyAssist: number
  // ... å…¶ä»–æ¬„ä½
}
```

### 10.2 å¾Œç«¯ API é€²åº¦

**ç‹€æ…‹**: âœ… **æ ¸å¿ƒ API å·²å®Œæˆ**

**å·²å»ºç«‹çš„æª”æ¡ˆ**:
- `backend/src/services/analytics_service.py` - åˆ†ææœå‹™
- `backend/src/services/period_metrics_service.py` - æœŸé–“æŒ‡æ¨™æœå‹™
- `backend/src/api/v1/endpoints/analytics.py` - Analytics API
- `backend/src/api/v1/endpoints/periods.py` - Period API
- `backend/src/repositories/member_period_metrics_repository.py` - æŒ‡æ¨™è³‡æ–™å­˜å–

**å·²å¯¦ä½œçš„ Endpoints**:

| Endpoint | æ–¹æ³• | ç‹€æ…‹ |
|----------|------|------|
| `/api/v1/analytics/members` | GET | âœ… å·²å®Œæˆ |
| `/api/v1/analytics/members/{member_id}/trend` | GET | âœ… å·²å®Œæˆ |
| `/api/v1/analytics/members/{member_id}/summary` | GET | âœ… å·²å®Œæˆ |
| `/api/v1/analytics/members/{member_id}/comparison` | GET | âœ… å·²å®Œæˆ |
| `/api/v1/analytics/periods/{period_id}/averages` | GET | âœ… å·²å®Œæˆ |
| `/api/v1/analytics/alliance/trend` | GET | âœ… å·²å®Œæˆ |
| `/api/v1/periods` | GET | âœ… å·²å®Œæˆ |

**å¾…å¯¦ä½œ**:
- çµ„åˆ¥åˆ†ä½ˆçµ±è¨ˆ APIï¼ˆBox Plot / å¥åº·åº¦é›·é”ï¼‰
- çµ„åˆ¥è²¢ç»ä½”æ¯”è¶¨å‹¢ API

### 10.3 å·²å®Œæˆé …ç›®

#### Phase 1: å€‹äººåˆ†æ âœ…

- [x] ç¢ºèªå‰ç«¯åœ–è¡¨è¨­è¨ˆæ˜¯å¦ç¬¦åˆéœ€æ±‚
- [x] å°‡ mock data æ›¿æ›ç‚ºçœŸå¯¦ API å‘¼å«
- [x] å»ºç«‹ TanStack Query hooks (`use-analytics.ts`)
- [x] å®Œå–„å¾Œç«¯ API éŒ¯èª¤è™•ç†
- [x] æˆå“¡è¶¨å‹¢åœ–ï¼ˆLine Chartï¼‰
- [x] æ’åæ­·å²åœ–ï¼ˆInverted Lineï¼‰
- [x] å››ç¶­é›·é”åœ–ï¼ˆRadar Chartï¼‰
- [x] åŒç›Ÿå¹³å‡å°æ¯”

#### Phase 2: çµ„åˆ¥åˆ†æ âœ…

- [x] å¯¦ä½œçµ„åˆ¥åˆ†æé é¢ (`GroupAnalytics.tsx`)
- [x] çµ„åˆ¥å°æ¯”åœ–è¡¨
- [x] æˆå“¡æ’è¡Œè¡¨æ ¼

### 10.4 å¾…è¾¦äº‹é …

#### å„ªåŒ–é …ç›®

- [ ] çµ„åˆ¥åˆ†ä½ˆçµ±è¨ˆ APIï¼ˆBox Plot / å¥åº·åº¦é›·é”ï¼‰
- [ ] çµ„åˆ¥è²¢ç»ä½”æ¯”è¶¨å‹¢ API
- [ ] Overview Dashboard æ•´åˆ
- [ ] é€²éšäº’å‹•åŠŸèƒ½ï¼ˆé»æ“Šè·³è½‰ï¼‰

---

**Last Updated**: 2025-12-07
**Status**: Phase 4 Complete - Member & Group Analytics Implemented
**Author**: AI Assistant + Product Owner
**Version**: 2.2 (Analytics Implementation Complete)
